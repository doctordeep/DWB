(function(b){function c(I,J,K){return K=r(J,K),this.on('click.pjax',I,function(L){var M=K;M.container||(M=b.extend({},K),M.container=b(this).attr('data-pjax')),d(L,M)})}function d(I,J,K){K=r(J,K);var L=I.currentTarget,M=b(L);if('A'!==L.tagName.toUpperCase())throw'$.fn.pjax or $.pjax.click requires an anchor element';if(!(1<I.which||I.metaKey||I.ctrlKey||I.shiftKey||I.altKey)&&location.protocol===L.protocol&&location.hostname===L.hostname&&!(-1<L.href.indexOf('#')&&q(L)==q(location))&&!I.isDefaultPrevented()){var N={url:L.href,container:M.attr('data-pjax'),target:L},O=b.extend({},N,K),P=b.Event('pjax:click');M.trigger(P,[O]),P.isDefaultPrevented()||(g(O),I.preventDefault(),M.trigger('pjax:clicked',[O]))}}function f(I,J,K){K=r(J,K);var L=I.currentTarget,M=b(L);if('FORM'!==L.tagName.toUpperCase())throw'$.pjax.submit requires a form element';var N={type:(M.attr('method')||'GET').toUpperCase(),url:M.attr('action'),container:M.attr('data-pjax'),target:L};if('GET'!==N.type&&window.FormData!==void 0)N.data=new FormData(L),N.processData=!1,N.contentType=!1;else{if(M.find(':file').length)return;N.data=M.serializeArray()}g(b.extend({},N,K)),I.preventDefault()}function g(I){function J(P,Q,R){R||(R={}),R.relatedTarget=I.target;var S=b.Event(P,R);return M.trigger(S,Q),!S.isDefaultPrevented()}I=b.extend(!0,{},b.ajaxSettings,g.defaults,I),b.isFunction(I.url)&&(I.url=I.url());var K=p(I.url).hash,L=b.type(I.container);if('string'!==L)throw'expected string value for \'container\' option; got '+L;var M=I.context=b(I.container);if(!M.length)throw'the container selector \''+I.container+'\' did not match anything';I.data||(I.data={}),b.isArray(I.data)?I.data.push({name:'_pjax',value:I.container}):I.data._pjax=I.container;var N;I.beforeSend=function(P,Q){if('GET'!==Q.type&&(Q.timeout=0),P.setRequestHeader('X-PJAX','true'),P.setRequestHeader('X-PJAX-Container',I.container),!J('pjax:beforeSend',[P,Q]))return!1;0<Q.timeout&&(N=setTimeout(function(){J('pjax:timeout',[P,I])&&P.abort('timeout')},Q.timeout),Q.timeout=0);var R=p(Q.url);K&&(R.hash=K),I.requestUrl=o(R)},I.complete=function(P,Q){N&&clearTimeout(N),J('pjax:complete',[P,Q,I]),J('pjax:end',[P,I])},I.error=function(P,Q,R){var S=u('',P,I),T=J('pjax:error',[P,Q,R,I]);'GET'==I.type&&'abort'!==Q&&T&&i(S.url)},I.success=function(P,Q,R){var S=g.state,T='function'==typeof b.pjax.defaults.version?b.pjax.defaults.version():b.pjax.defaults.version,U=R.getResponseHeader('X-PJAX-Version'),V=u(P,R,I),W=p(V.url);if(K&&(W.hash=K,V.url=W.href),T&&U&&T!==U)return void i(V.url);if(!V.contents)return void i(V.url);g.state={id:I.id||m(),url:V.url,title:V.title,container:I.container,fragment:I.fragment,timeout:I.timeout},(I.push||I.replace)&&window.history.replaceState(g.state,V.title,V.url);var X=b.contains(M,document.activeElement);if(X)try{document.activeElement.blur()}catch(ba){}V.title&&(document.title=V.title),J('pjax:beforeReplace',[V.contents,I],{state:g.state,previousState:S}),M.html(V.contents);var Y=M.find('input[autofocus], textarea[autofocus]').last()[0];Y&&document.activeElement!==Y&&Y.focus(),v(V.scripts);var Z=I.scrollTo;if(K){var _=decodeURIComponent(K.slice(1)),aa=document.getElementById(_)||document.getElementsByName(_)[0];aa&&(Z=b(aa).offset().top)}'number'==typeof Z&&b(window).scrollTop(Z),J('pjax:success',[P,Q,R,I])},g.state||(g.state={id:m(),url:window.location.href,title:document.title,container:I.container,fragment:I.fragment,timeout:I.timeout},window.history.replaceState(g.state,document.title)),l(g.xhr),g.options=I;var O=g.xhr=b.ajax(I);return 0<O.readyState&&(I.push&&!I.replace&&(w(g.state.id,[I.container,n(M)]),window.history.pushState(null,'',I.requestUrl)),J('pjax:start',[O,I]),J('pjax:send',[O,I])),g.xhr}function h(I,J){var K={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return g(b.extend(K,r(I,J)))}function i(I){window.history.replaceState(null,'',g.state.url),window.location.replace(I)}function j(I){C||l(g.xhr);var J=g.state,K=I.state,L;if(K&&K.container){if(C&&D==K.url)return;if(J){if(J.id===K.id)return;L=J.id<K.id?'forward':'back'}var M=F[K.id]||[],N=M[0]||K.container,O=b(N),P=M[1];if(O.length){J&&x(L,J.id,[N,n(O)]);var Q=b.Event('pjax:popstate',{state:K,direction:L});O.trigger(Q);var R={id:K.id,url:K.url,container:N,push:!1,fragment:K.fragment,timeout:K.timeout,scrollTo:!1};if(P){O.trigger('pjax:start',[null,R]),g.state=K,K.title&&(document.title=K.title);var S=b.Event('pjax:beforeReplace',{state:K,previousState:J});O.trigger(S,[P,R]),O.html(P),O.trigger('pjax:end',[null,R])}else g(R);O[0].offsetHeight}else i(location.href)}C=!1}function k(I){var J=b.isFunction(I.url)?I.url():I.url,K=I.type?I.type.toUpperCase():'GET',L=b('<form>',{method:'GET'===K?'GET':'POST',action:J,style:'display:none'});'GET'!==K&&'POST'!==K&&L.append(b('<input>',{type:'hidden',name:'_method',value:K.toLowerCase()}));var M=I.data;if('string'==typeof M)b.each(M.split('&'),function(O,P){var Q=P.split('=');L.append(b('<input>',{type:'hidden',name:Q[0],value:Q[1]}))});else if(b.isArray(M))b.each(M,function(O,P){L.append(b('<input>',{type:'hidden',name:P.name,value:P.value}))});else if('object'==typeof M){for(var N in M)L.append(b('<input>',{type:'hidden',name:N,value:M[N]}))}b(document.body).append(L),L.submit()}function l(I){I&&4>I.readyState&&(I.onreadystatechange=b.noop,I.abort())}function m(){return new Date().getTime()}function n(I){var J=I.clone();return J.find('script').each(function(){this.src||b._data(this,'globalEval',!1)}),J.contents()}function o(I){return I.search=I.search.replace(/([?&])(_pjax|_)=[^&]*/g,'').replace(/^&/,''),I.href.replace(/\?($|#)/,'$1')}function p(I){var J=document.createElement('a');return J.href=I,J}function q(I){return I.href.replace(/#.*/,'')}function r(I,J){return I&&J?(J=b.extend({},J),J.container=I,J):b.isPlainObject(I)?I:{container:I}}function s(I,J){return I.filter(J).add(I.find(J))}function t(I){return b.parseHTML(I,document,!0)}function u(I,J,K){var L={},M=/<html/i.test(I),N=J.getResponseHeader('X-PJAX-URL');L.url=N?o(p(N)):K.requestUrl;var O,P;if(M){P=b(t(I.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));var Q=I.match(/<head[^>]*>([\s\S.]*)<\/head>/i);O=null==Q?P:b(t(Q[0]))}else O=P=b(t(I));if(0===P.length)return L;if(L.title=s(O,'title').last().text(),K.fragment){var R=P;'body'!==K.fragment&&(R=s(R,K.fragment).first()),R.length&&(L.contents='body'===K.fragment?R:R.contents(),!L.title&&(L.title=R.attr('title')||R.data('title')))}else M||(L.contents=P);return L.contents&&(L.contents=L.contents.not(function(){return b(this).is('title')}),L.contents.find('title').remove(),L.scripts=s(L.contents,'script[src]').remove(),L.contents=L.contents.not(L.scripts)),L.title&&(L.title=b.trim(L.title)),L}function v(I){if(I){var J=b('script[src]');I.each(function(){var K=this.src,L=J.filter(function(){return this.src===K});if(!L.length){var M=document.createElement('script'),N=b(this).attr('type');N&&(M.type=N),M.src=b(this).attr('src'),document.head.appendChild(M)}})}}function w(I,J){F[I]=J,H.push(I),y(G,0),y(H,g.defaults.maxCacheLength)}function x(I,J,K){var L,M;F[J]=K,'forward'===I?(L=H,M=G):(L=G,M=H),L.push(J),J=M.pop(),J&&delete F[J],y(L,g.defaults.maxCacheLength)}function y(I,J){for(;I.length>J;)delete F[I.shift()]}function z(){return b('meta').filter(function(){var I=b(this).attr('http-equiv');return I&&'X-PJAX-VERSION'===I.toUpperCase()}).attr('content')}function A(){b.fn.pjax=c,b.pjax=g,b.pjax.enable=b.noop,b.pjax.disable=B,b.pjax.click=d,b.pjax.submit=f,b.pjax.reload=h,b.pjax.defaults={timeout:650,push:!0,replace:!1,type:'GET',dataType:'html',scrollTo:0,maxCacheLength:20,version:z},b(window).on('popstate.pjax',j)}function B(){b.fn.pjax=function(){return this},b.pjax=k,b.pjax.enable=A,b.pjax.disable=b.noop,b.pjax.click=b.noop,b.pjax.submit=b.noop,b.pjax.reload=function(){window.location.reload()},b(window).off('popstate.pjax',j)}var C=!0,D=window.location.href,E=window.history.state;E&&E.container&&(g.state=E),'state'in window.history&&(C=!1);var F={},G=[],H=[];b.event.props&&0>b.inArray('state',b.event.props)?b.event.props.push('state'):!('state'in b.Event.prototype)&&b.event.addProp('state'),b.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),b.support.pjax?A():B()})(jQuery);